<div class="space-y-4">
  <div class="flex items-center justify-between">
    <h4 class="text-sm font-medium text-gray-300">Assign Managers</h4>
    <span class="text-xs text-gray-500">{{ managers().length }} Available</span>
  </div>

  @if (isLoading()) {
    <div
      class="flex items-center justify-center p-8 rounded-lg border border-dashed border-white/10 text-gray-500"
    >
      Loading eligible users...
    </div>
  } @else {
    <div
      class="grid grid-cols-1 sm:grid-cols-2 gap-3 max-h-60 overflow-y-auto pr-1 custom-scrollbar"
    >
      @for (user of managers(); track user.id) {
        <div
          class="group relative flex items-center p-3 rounded-lg border cursor-pointer transition-all duration-200"
          [class.border-blue-500]="isSelected(user.id)"
          [class.bg-blue-500/10]="isSelected(user.id)"
          [class.border-white/10]="!isSelected(user.id)"
          [class.bg-white/5]="!isSelected(user.id)"
          [class.hover:border-white/30]="!isSelected(user.id)"
          (click)="toggleSelection(user.id)"
          (keydown.enter)="toggleSelection(user.id)"
          tabindex="0"
          role="checkbox"
          [attr.aria-checked]="isSelected(user.id)"
        >
          <!-- Avatar -->
          <div class="relative flex-shrink-0 mr-3">
            <img
              [src]="user.photoUrl || 'assets/default-avatar.png'"
              alt=""
              class="w-10 h-10 rounded-full object-cover bg-gray-700 ring-2 ring-transparent group-hover:ring-white/10 transition-all"
            />
            @if (isSelected(user.id)) {
              <div
                class="absolute -bottom-1 -right-1 bg-blue-500 text-white rounded-full p-0.5 shadow-sm"
              >
                <svg
                  class="w-3 h-3"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  stroke-width="3"
                >
                  <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path>
                </svg>
              </div>
            }
          </div>

          <!-- Info -->
          <div class="flex flex-col overflow-hidden">
            <span
              class="text-sm font-medium text-gray-200 truncate group-hover:text-white transition-colors"
              >{{ user.name }}</span
            >
            <span
              class="text-xs text-gray-500 truncate group-hover:text-gray-400 transition-colors"
              >{{ user.email }}</span
            >
            <span
              class="text-[10px] uppercase tracking-wider font-semibold mt-0.5
                    {{ user.role === 3 ? 'text-amber-500' : 'text-blue-400' }}"
            >
              {{ user.role === 3 ? 'Admin' : 'Creator' }}
            </span>
          </div>

          <!-- Checkmark Bg (Subtle) -->
          @if (isSelected(user.id)) {
            <div
              class="absolute inset-0 rounded-lg ring-1 ring-inset ring-blue-500/50 pointer-events-none"
            ></div>
          }
        </div>
      } @empty {
        <div
          class="col-span-2 flex flex-col items-center justify-center p-8 rounded-lg border border-dashed border-white/10 text-center"
        >
          <span class="material-icons text-gray-600 text-3xl mb-2">people_outline</span>
          <p class="text-sm text-gray-500">No eligible managers found.</p>
          <p class="text-xs text-gray-600 mt-1">Only Creators and Admins can be assigned.</p>
        </div>
      }
    </div>
  }

  <p
    class="text-xs text-blue-300 bg-blue-500/5 p-3 rounded border border-blue-500/10 flex items-start gap-2"
  >
    <span class="material-icons text-sm text-blue-400 mt-0.5">info</span>
    <span
      >Assigned managers can edit this event but cannot manage other managers or delete the
      event.</span
    >
  </p>
</div>
